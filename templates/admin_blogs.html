<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            background-color: #030303;
            color: white;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        .tab-button {
            transition: all 0.6s cubic-bezier(0.25, 0.4, 0.25, 1);
        }
        .tab-text {
            transition: all 0.8s cubic-bezier(0.25, 0.4, 0.25, 1);
            max-width: 0;
            opacity: 0;
            overflow: hidden;
            white-space: nowrap;
        }
        .tab-text.expanded {
            max-width: 200px;
            opacity: 1;
            margin-left: 0.5rem;
        }
        .tab-button.selected {
            padding-left: 1rem;
            padding-right: 1rem;
        }
        .tab-button:not(.selected) {
            padding-left: 0.75rem;
            padding-right: 0.75rem;
        }
        .separator {
            width: 1px;
            height: 20px;
            margin: 0 0.5rem;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to   { opacity: 1; transform: translateY(0); }
        }
        .anim-hidden-initial {
            opacity: 0;
        }
        .content-section {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }
        .content-section.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .form-container {
            max-width: none;
            margin: 0;
            padding: 1rem;
        }
        .form-item {
            margin-bottom: 1rem;
        }
        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: white;
            font-family: 'Inter', sans-serif;
            letter-spacing: 0.025em;
        }
        .form-input {
            width: 100%;
            height: 2.25rem;
            padding: 0.5rem 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.5rem;
            background-color: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 0.875rem;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        .form-input:focus {
            outline: none;
            border-color: rgb(59, 130, 246);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }
        .form-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            background-color: rgb(59, 130, 246);
            color: white;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            font-family: 'Inter', sans-serif;
            letter-spacing: 0.025em;
        }
        .form-button:hover {
            background-color: rgb(37, 99, 235);
        }
        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: white;
            letter-spacing: -0.025em;
        }
        .section-content {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }
        .form-row {
            display: flex;
            gap: 1rem;
        }
        .form-row .form-item {
            flex: 1;
        }
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
        
        /* Calendar icon for date input */
        input[type="date"] {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>');
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1rem;
        }
        
        /* Remove button styling and animation */
        .remove-section {
            transition: all 0.3s ease;
            color: white !important;
        }
        .remove-section:hover {
            color: white !important;
            transform: rotate(90deg);
        }
        
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: transparent;
            backdrop-filter: blur(5px);
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s ease-out;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: white;
            margin: 0;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            color: white;
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .modal-body {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }
        
        .modal-url-link {
            color: #60a5fa;
            text-decoration: underline;
            word-break: break-all;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
            transition: color 0.2s ease;
        }
        
        .modal-url-link:hover {
            color: #93c5fd;
            text-decoration: none;
        }
        
        .modal-body p {
            word-break: break-word;
            overflow-wrap: break-word;
        }
        
        .modal-button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Inter', sans-serif;
        }
        
        .modal-button-primary {
            background-color: rgb(59, 130, 246);
            color: white;
        }
        
        .modal-button-primary:hover {
            background-color: rgb(37, 99, 235);
        }
        
        .modal-button-secondary {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .modal-button-secondary:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .error-modal .modal-title {
            color: #ef4444;
        }
        
        .success-modal .modal-title {
            color: #10b981;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        /* Line clamp utility for text truncation */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Blog list item hover effects */
        .blog-item {
            transition: all 0.2s ease-in-out;
        }
        
        .blog-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        /* Pagination button styles */
        .pagination-btn {
            transition: all 0.2s ease-in-out;
        }
        
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .pagination-btn:not(:disabled):hover {
            transform: translateY(-1px);
        }
        
        /* Search input focus enhancement */
        .search-input:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            border-color: rgb(59, 130, 246);
        }
        
        /* Status badge styles */
        .status-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-weight: 500;
        }
        
        .status-published {
            background-color: rgba(34, 197, 94, 0.2);
            color: rgb(74, 222, 128);
        }
        
        .status-draft {
            background-color: rgba(234, 179, 8, 0.2);
            color: rgb(250, 204, 21);
        }
        
        /* Grid Layout Styles */
        .main-grid-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 16px;
            min-height: calc(100vh - 120px);
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .left-section {
            grid-column: span 3 / span 3;
            grid-row: span 5 / span 5;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            overflow-y: auto;
            overflow-x: hidden;
            max-height: calc(100vh - 140px);
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .left-section::-webkit-scrollbar {
            display: none;
        }
        
        .right-section {
            grid-column: span 2 / span 2;
            grid-row: span 5 / span 5;
            grid-column-start: 4;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            overflow-y: auto;
            overflow-x: hidden;
            max-height: calc(100vh - 140px);
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .right-section::-webkit-scrollbar {
            display: none;
        }
        
        .left-section-header {
            backdrop-filter: blur(35px);
            -webkit-backdrop-filter: blur(35px);
            /* background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05); */
            border-radius: 70px;
            padding: 12px 20px;
            margin-bottom: 2rem;
        }
        
        .left-section-tabs {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .left-tab-button {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 1.5rem;
            /* background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1); */
            border-radius: 12px;
            color: rgba(255, 255, 255, 0.5);
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .left-tab-button:hover {
            /* background: rgba(255, 255, 255, 0.1); */
            color: rgba(255, 255, 255, 0.9);
            transform: translateY(-2px);
        }
        
        .left-tab-button.active {
            /* background: rgba(59, 130, 246, 0.2); */
            color: rgba(255, 255, 255, 0.9);;
        }
        
        .left-content-section {
            display: none;
            margin-top: 1.5rem;
        }
        
        .left-content-section.active {
            display: block;
        }
        
        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .main-grid-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto;
                gap: 1rem;
            }
            
            .left-section {
                grid-column: 1;
                grid-row: 1;
            }
            
            .right-section {
                grid-column: 1;
                grid-row: 2;
                grid-column-start: auto;
            }
            
            .left-section-tabs {
                flex-direction: row;
                flex-wrap: wrap;
            }
        }
        
        @media (max-width: 768px) {
            .main-grid-container {
                padding: 0 1rem;
            }
            
            .left-section, .right-section {
                padding: 1rem;
            }
        }
        
        /* Upload and Gallery Styles from manage_files.html */
        .dropzone {
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 2.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: rgba(255, 255, 255, 0.02);
        }
        .dropzone.dragover {
            border-color: rgb(59, 130, 246);
            background-color: rgba(59, 130, 246, 0.1);
        }
        .dropzone i,
        .dropzone p {
            transition: opacity 0.2s ease-in-out;
        }
        .file-queue-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            border-radius: 20px;
            background-color: rgba(255, 255, 255, 0.05);
        }
        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 20px;
            transition: all 0.2s ease;
            background-color: rgba(255, 255, 255, 0.03);
        }
        .gallery-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        .gallery-item .overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent 50%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .gallery-item:hover .overlay {
            opacity: 1;
        }
        .gallery-item .actions {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            display: flex;
            gap: 0.5rem;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 10;
            pointer-events: auto;
        }
        .gallery-item:hover .actions {
            opacity: 1;
            transform: translateY(0);
        }
        .gallery-item .actions button {
            border-radius: 9999px;
            padding: 0.5rem;
            background-color: rgba(0,0,0,0.5);
            transition: background-color 0.2s;
        }
        .gallery-item .actions button:hover {
             background-color: black;
        }
        .search-input-container {
            position: relative;
        }
        .search-input-container::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 1px;
            background-color: rgba(255, 255, 255, 0.6);
            transform: translateX(-50%);
            transition: width 0.3s ease-in-out;
        }
        .search-input-container:hover::after {
            width: 100%;
        }
        .search-input-container.focused::after {
            width: 100%;
        }
        .search-input {
            background-color: transparent;
            border: none;
            color: white;
            transition: all 0.3s ease-in-out;
        }
        .search-input:focus {
            outline: none;
        }
        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <nav class="fixed top-0 left-0 right-0 z-50">
        <div class="flex justify-center py-6">
            <div class="navbar-wrapper" style="backdrop-filter: blur(35px); -webkit-backdrop-filter: blur(35px); background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 70px; padding: 12px 20px;">
                <div id="navbarTabs" class="expandable-tabs flex items-center gap-4 anim-hidden-initial" style="animation: slideDown 0.8s cubic-bezier(0.25, 0.4, 0.25, 1) 0.3s forwards;">
                </div>
            </div>
        </div>
    </nav>
    <div class="fixed inset-0 bg-gradient-to-br from-indigo-500/[0.03] via-transparent to-rose-500/[0.03] pointer-events-none"></div>
    
    <!-- Main Content Sections -->
    <main class="pt-20 px-4">
        <div class="main-grid-container">
            <!-- Left Section -->
            <div class="left-section">
                <!-- Left Section Header -->
                <div class="left-section-header">
                    <div class="expandable-tabs flex items-center gap-4">
                        <button class="left-tab-button active" data-left-tab="upload">
                            <div class="flex-shrink-0">
                                <i data-lucide="upload" class="w-4 h-4"></i>
                            </div>
                            <span>Upload Image</span>
                        </button>
                        <button class="left-tab-button" data-left-tab="gallery">
                            <div class="flex-shrink-0">
                                <i data-lucide="image" class="w-4 h-4"></i>
                            </div>
                            <span>Gallery</span>
                        </button>
                    </div>
                </div>

                <!-- Left Section Content -->
                <div id="uploadContent" class="left-content-section active">
                    <h3 class="text-lg font-semibold mb-4 text-white" style="font-family: 'Playfair Display', serif;">Upload Images</h3>
                    <div class="bg-black/20 border-white/10 rounded-[20px] p-6">
                        <!-- Dropzone -->
                        <div id="leftDropzone" class="dropzone flex flex-col items-center justify-center space-y-3" style="border: 2px dashed rgba(255, 255, 255, 0.2); border-radius: 20px; padding: 2.5rem; text-align: center; cursor: pointer; transition: all 0.2s ease; background-color: rgba(255, 255, 255, 0.02);">
                            <i id="leftDropzoneIcon" data-lucide="upload-cloud" class="w-12 h-12 text-white/40"></i>
                            <p class="font-semibold">Drag & drop images here</p>
                            <p id="leftDropzoneText" class="text-sm text-white/60">Upload JPG, PNG, WEBP. Max 10MB.</p>
                            <p class="text-xs text-white/50">or</p>
                            <button type="button" onclick="document.getElementById('leftFileInput').click()" class="form-button bg-white/10 hover:bg-white/20 text-white/90 !px-4 !py-2">Browse Files</button>
                        </div>
                        <input type="file" id="leftFileInput" multiple accept="image/*" class="hidden">
                        
                        <!-- File Queue -->
                        <div id="leftFileQueue" class="mt-6 space-y-3"></div>
                        
                        <!-- Upload Button -->
                        <div class="mt-8 flex justify-center">
                            <button id="leftUploadBtn" class="form-button bg-white text-black hover:bg-gray-100" disabled>
                                <i data-lucide="upload" class="w-4 h-4 mr-2"></i>
                                <span id="leftUploadBtnText">Upload 0 Files</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div id="galleryContent" class="left-content-section">
                    <h3 class="text-lg font-semibold mb-4 text-white" style="font-family: 'Playfair Display', serif;">Image Gallery</h3>
                    
                    <!-- Search Bar -->
                    <div class="relative mb-6">
                        <div class="search-input-container" style="position: relative;">
                            <i data-lucide="search" class="w-4 h-4 absolute left-4 top-1/2 -translate-y-1/2 text-white/40 z-10"></i>
                            <input type="text" placeholder="Search images..." class="search-input w-full py-2 pl-11 pr-4 text-sm rounded-[20px] focus:ring-0 focus:outline-none transition bg-transparent border-none color-white" id="leftSearchInput" style="background-color: transparent; border: none; color: white;">
                        </div>
                    </div>
                    
                    <!-- Gallery Grid -->
                    <div id="leftGalleryGrid" class="grid grid-cols-4 gap-4">
                        <!-- Dynamic gallery items will be inserted here -->
                    </div>
                    
                    <div id="leftNoGalleryItems" class="text-center py-8 hidden">
                        <i data-lucide="folder-x" class="w-12 h-12 mx-auto text-white/20 mb-4"></i>
                        <h4 class="text-lg font-medium text-white/80">No Images Found</h4>
                        <p class="text-white/50 mt-2">Try uploading some images or changing your search.</p>
                    </div>
                </div>

            </div>

            <!-- Right Section -->
            <div class="right-section">
                <!-- Add Blogs Section -->
                <section id="addBlogs" class="content-section active">
                    <div class="form-container">
                        <h2 class="section-title text-center">Add New Blog</h2>
                <form id="addBlogForm">
                    <!-- Main Image URL and Alt Text -->
                    <div class="form-row">
                        <div class="form-item">
                            <label class="form-label" for="mainImageUrl">
                                <i data-lucide="image" class="w-4 h-4 inline mr-2"></i>Main Image URL
                            </label>
                            <input
                                type="url"
                                id="mainImageUrl"
                                name="mainImageUrl"
                                class="form-input"
                                placeholder="https://example.com/image.jpg"
                                required
                            />
                        </div>
                        <div class="form-item">
                            <label class="form-label" for="mainImageAlt">
                                <i data-lucide="type" class="w-4 h-4 inline mr-2"></i>Main Image Alt Text
                            </label>
                            <input
                                type="text"
                                id="mainImageAlt"
                                name="mainImageAlt"
                                class="form-input"
                                placeholder="Describe the image..."
                                required
                            />
                        </div>
                    </div>

                    <!-- Blog Title -->
                    <div class="form-item">
                        <label class="form-label" for="blogTitle">
                            <i data-lucide="heading" class="w-4 h-4 inline mr-2"></i>Blog Title
                        </label>
                        <input
                            type="text"
                            id="blogTitle"
                            name="blogTitle"
                            class="form-input"
                            placeholder="Enter blog title..."
                            required
                        />
                    </div>

                    <!-- Blog Author and Publish Date -->
                    <div class="form-row">
                        <div class="form-item">
                            <label class="form-label" for="blogAuthor">
                                <i data-lucide="user" class="w-4 h-4 inline mr-2"></i>Blog Author
                            </label>
                            <input
                                type="text"
                                id="blogAuthor"
                                name="blogAuthor"
                                class="form-input"
                                placeholder="Enter author name..."
                                required
                            />
                        </div>
                        <div class="form-item">
                            <label class="form-label" for="blogDate">
                                <i data-lucide="calendar" class="w-4 h-4 inline mr-2"></i>Blog Publish Date (Optional)
                            </label>
                            <input
                                type="date"
                                id="blogDate"
                                name="blogDate"
                                class="form-input"
                            />
                        </div>
                    </div>

                    <!-- Blog Summary -->
                    <div class="form-item">
                        <label class="form-label" for="blogSummary">
                            <i data-lucide="file-text" class="w-4 h-4 inline mr-2"></i>Blog Summary
                        </label>
                        <textarea
                            id="blogSummary"
                            name="blogSummary"
                            class="form-input"
                            style="height: 6rem; resize: vertical;"
                            placeholder="Write a brief summary of your blog..."
                            required
                        ></textarea>
                    </div>

                    <!-- Blog Status (Only visible in edit mode) -->
                    <div class="form-item" id="blogStatusSection" style="display: none;">
                        <label class="form-label">
                            <i data-lucide="settings" class="w-4 h-4 inline mr-2"></i>Blog Status
                        </label>
                        <div class="flex gap-4">
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="radio" name="blogStatus" value="draft" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500">
                                <span class="text-sm text-white">Draft</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="radio" name="blogStatus" value="published" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500">
                                <span class="text-sm text-white">Published</span>
                            </label>
                        </div>
                    </div>

                    <!-- Ad Banner One (Beside Leadership Spotlight) -->
                    <div class="form-item">
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="image" class="w-4 h-4 mr-2"></i>Ad Banner (Beside Leadership Spotlight)
                            </label>
                        </div>
                        <div class="space-y-2">
                            <input type="url" name="adBannerBesideUrl" class="form-input" placeholder="Image URL..." value="">
                            <input type="url" name="adBannerBesideHref" class="form-input" placeholder="Href for ad banner..." value="">
                        </div>
                    </div>

                    <!-- Ad Banner Two (Below Leadership Spotlight) -->
                    <div class="form-item">
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="image" class="w-4 h-4 mr-2"></i>Ad Banner (Below Leadership Spotlight)
                            </label>
                        </div>
                        <div class="space-y-2">
                            <input type="url" name="adBannerBelowUrl" class="form-input" placeholder="Image URL..." value="">
                            <input type="url" name="adBannerBelowHref" class="form-input" placeholder="Href for ad banner..." value="">
                        </div>
                    </div>                   

                    <!-- Dynamic Content Sections -->
                    <div class="form-item">
                        <label class="form-label">
                            <i data-lucide="layers" class="w-4 h-4 inline mr-2"></i>Content Sections
                        </label>
                        
                        <!-- Dynamic Sections Container - Moved to top -->
                        <div id="dynamicSections" class="space-y-4 mb-4">
                            <!-- Dynamic sections will be added here -->
                        </div>
                        
                        <!-- Add Section Buttons - Moved to bottom for easy access -->
                        <div class="flex flex-wrap gap-2">
                            <button type="button" id="addTextBtn" class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add Text Content">
                                <i data-lucide="type" class="w-4 h-4"></i>
                                
                            </button>
                            <button type="button" id="addHeaderBtn" class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add Header">
                                <i data-lucide="heading-2" class="w-4 h-4"></i>
                                
                            </button>
                            <button type="button" id="addSubHeaderBtn" class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add Sub Header">
                                <i data-lucide="heading-3" class="w-4 h-4"></i>
                                
                            </button>
                            <button type="button" id="addSubHeaderTextBtn" class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add Sub Header Text">
                                <i data-lucide="heading-3" class="w-4 h-4"></i>
                                -
                                <i data-lucide="type" class="w-4 h-4"></i>
                                
                            </button>
                            <button type="button" id="addImageBtn" class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add Image">
                                <i data-lucide="image" class="w-4 h-4"></i>
                                
                            </button>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex justify-end gap-3">
                        <!-- Add Mode Buttons -->
                        <div id="addModeButtons" style="gap: 1rem;">
                            <button type="button" id="loadPreviewBtn" class="form-button bg-white hover:bg-gray-100 text-black">
                                <i data-lucide="eye" class="w-4 h-4 mr-2"></i>
                                Preview
                            </button>
                            <button type="button" id="saveDraftBtn" class="form-button bg-gray-600 hover:bg-gray-700 text-white">
                                <i data-lucide="file-text" class="w-4 h-4 mr-2"></i>
                                Draft
                            </button>
                            <button type="submit" id="savePublishBtn" class="form-button bg-green-600 hover:bg-green-700 text-white">
                                <i data-lucide="send" class="w-4 h-4 mr-2"></i>
                                Publish
                            </button>
                        </div>
                        
                        <!-- Edit Mode Buttons -->
                        <div id="editModeButtons" style="display: none; gap: 1rem;">
                            <button type="button" id="loadPreviewEditBtn" class="form-button bg-white hover:bg-gray-100 text-black">
                                <i data-lucide="eye" class="w-4 h-4 mr-2"></i>
                                Preview
                            </button>
                            <button type="button" id="deleteBlogBtn" class="form-button bg-red-600 hover:bg-red-700 text-white">
                                <i data-lucide="trash-2" class="w-4 h-4 mr-2"></i>
                                Delete
                            </button>
                            <button type="button" id="updateBlogBtn" class="form-button bg-green-600 hover:bg-green-700 text-white">
                                <i data-lucide="save" class="w-4 h-4 mr-2"></i>
                                Update
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </section>

        <!-- Edit/Delete Blog Section -->
        <section id="editBlogs" class="content-section">
            <div class="form-container">
                <h2 class="section-title text-center">Edit/Delete Blog</h2>
                <div class="section-content">
                    <!-- Search Bar -->
                    <div class="mb-6">
                        <label class="form-label" for="searchBlog">
                            <i data-lucide="search" class="w-4 h-4 inline mr-2"></i>Search Blog to Edit
                        </label>
                        <div class="relative">
                            <input
                                type="text"
                                id="searchBlog"
                                class="form-input pr-10"
                                placeholder="Search by title, author, or content..."
                            />
                            <div class="absolute inset-y-0 right-0 flex items-center pr-3">
                                <i data-lucide="search" class="w-4 h-4 text-white/40"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div id="blogsLoading" class="text-center py-8 hidden">
                        <i data-lucide="loader-2" class="w-6 h-6 animate-spin mx-auto mb-2 text-white/60"></i>
                        <p class="text-white/60">Loading blogs...</p>
                    </div>

                    <!-- No Results State -->
                    <div id="noBlogsFound" class="text-center py-8 hidden">
                        <i data-lucide="file-x" class="w-12 h-12 mx-auto mb-4 text-white/40"></i>
                        <h3 class="text-lg font-semibold mb-2 text-white/80">No blogs found</h3>
                        <p class="text-white/60">Try adjusting your search terms or check back later.</p>
                    </div>

                    <!-- Blogs List Container -->
                    <div id="blogsList" class="space-y-4">
                        <!-- Dynamic blog entries will be inserted here -->
                    </div>

                    <!-- Pagination Controls -->
                    <div id="paginationControls" class="flex justify-center items-center gap-4 mt-6 hidden">
                        <button id="prevPage" class="form-button bg-gray-600 hover:bg-gray-700 text-xs px-3 py-2 disabled:opacity-50 disabled:cursor-not-allowed">
                            <i data-lucide="chevron-left" class="w-3 h-3 mr-1"></i>
                            Previous
                        </button>
                        <span id="pageInfo" class="text-sm text-white/60 px-4">
                            Page 1 of 1
                        </span>
                        <button id="nextPage" class="form-button bg-gray-600 hover:bg-gray-700 text-xs px-3 py-2 disabled:opacity-50 disabled:cursor-not-allowed">
                            Next
                            <i data-lucide="chevron-right" class="w-3 h-3 ml-1"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Manage Images Section -->
        <!-- <section id="manageImages" class="content-section">
            <div class="form-container">
                <h2 class="section-title">Manage Images</h2>
                <div class="section-content">
                    <div class="mb-6">
                        <label class="form-label" for="imageUpload">Upload New Image</label>
                        <input
                            type="file"
                            id="imageUpload"
                            accept="image/*"
                            class="form-input"
                            style="padding-top: 0.375rem; padding-bottom: 0.375rem;"
                        />
                        <button class="form-button mt-2">
                            <i data-lucide="upload" class="w-4 h-4 mr-2"></i>
                            Upload Image
                        </button>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <div class="relative group">
                            <div class="aspect-square bg-white/5 rounded-lg border border-white/10 flex items-center justify-center">
                                <i data-lucide="image" class="w-8 h-8 text-white/40"></i>
                            </div>
                            <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center">
                                <div class="flex gap-2">
                                    <button class="form-button text-xs px-2 py-1">
                                        <i data-lucide="eye" class="w-3 h-3"></i>
                                    </button>
                                    <button class="form-button bg-red-600 hover:bg-red-700 text-xs px-2 py-1">
                                        <i data-lucide="trash-2" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                            <p class="text-xs text-white/60 mt-2 text-center">image1.jpg</p>
                        </div>
                        <div class="relative group">
                            <div class="aspect-square bg-white/5 rounded-lg border border-white/10 flex items-center justify-center">
                                <i data-lucide="image" class="w-8 h-8 text-white/40"></i>
                            </div>
                            <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center">
                                <div class="flex gap-2">
                                    <button class="form-button text-xs px-2 py-1">
                                        <i data-lucide="eye" class="w-3 h-3"></i>
                                    </button>
                                    <button class="form-button bg-red-600 hover:bg-red-700 text-xs px-2 py-1">
                                        <i data-lucide="trash-2" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                            <p class="text-xs text-white/60 mt-2 text-center">image2.jpg</p>
                        </div>
                        <div class="relative group">
                            <div class="aspect-square bg-white/5 rounded-lg border border-white/10 flex items-center justify-center">
                                <i data-lucide="image" class="w-8 h-8 text-white/40"></i>
                            </div>
                            <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center">
                                <div class="flex gap-2">
                                    <button class="form-button text-xs px-2 py-1">
                                        <i data-lucide="eye" class="w-3 h-3"></i>
                                    </button>
                                    <button class="form-button bg-red-600 hover:bg-red-700 text-xs px-2 py-1">
                                        <i data-lucide="trash-2" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                            <p class="text-xs text-white/60 mt-2 text-center">image3.jpg</p>
                        </div>
                    </div>
                </div>
            </div>
        </section> -->
            </div>
        </div>
    </main>
    
    <!-- Modal for displaying messages -->
    <div id="messageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle" class="modal-title">Message</h3>
                <button type="button" class="modal-close" onclick="closeModal()">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="modal-body">
                <p id="modalMessage">Message content goes here.</p>
            </div>
        </div>
    </div>
    
    <script>
       
        function showModal(title, message, type = 'info') {
            const modal = document.getElementById('messageModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalMessage = document.getElementById('modalMessage');
            const modalContent = modal.querySelector('.modal-content');
            
           
            modalTitle.textContent = title;
            modalMessage.style.whiteSpace = 'pre-line';
            
           
            const urlRegex = /(https?:\/\/[^\s]+)/g;
            if (urlRegex.test(message)) {
                modalMessage.innerHTML = message.replace(urlRegex, '<a href="$1" target="_blank" rel="noopener noreferrer" class="modal-url-link">$1</a>');
            } else {
                modalMessage.textContent = message;
            }
            
           
            modalContent.classList.remove('error-modal', 'success-modal');
            
           
            if (type === 'error') {
                modalContent.classList.add('error-modal');
            } else if (type === 'success') {
                modalContent.classList.add('success-modal');
            }
            
           
            modal.classList.add('show');
            
           
            lucide.createIcons();
        }
        
        function closeModal() {
            const modal = document.getElementById('messageModal');
            modal.classList.remove('show');
        }
        
       
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('messageModal');
            if (event.target === modal) {
                closeModal();
            }
        });
        
       
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        });
        
        class ExpandableTabs {
            constructor(container, options = {}) {
                this.container = container;
                this.tabs = options.tabs || [];
                this.activeColor = options.activeColor || 'text-blue-600';
                this.onChange = options.onChange || (() => {});
                this.selected = null;
                this.init();
            }
            init() {
                this.render();
                this.bindEvents();
            }
            render() {
                this.container.innerHTML = '';
                this.tabs.forEach((tab, index) => {
                    if (tab.type === 'separator') {
                        const separator = this.createSeparator();
                        this.container.appendChild(separator);
                    } else {
                        const button = this.createTabButton(tab, index);
                        this.container.appendChild(button);
                    }
                });
            }
            createSeparator() {
                const separator = document.createElement('div');
                separator.className = 'separator';
                separator.style.background = 'rgba(255, 255, 255, 0.3)';
                separator.setAttribute('aria-hidden', 'true');
                return separator;
            }
            createTabButton(tab, index) {
                const button = document.createElement('button');
                const isSelected = this.selected === index;
                button.className = `tab-button relative flex items-center text-sm font-medium tracking-wide transition-all duration-[600ms] ${
                    isSelected ? 'selected' : ''
                }`;
                if (isSelected) {
                    button.style.color = this.activeColor || 'rgb(147, 197, 253)';
                } else {
                    button.style.color = 'rgba(255, 255, 255, 0.6)';
                }
                button.dataset.index = index;
                const iconWrapper = document.createElement('div');
                iconWrapper.className = 'flex-shrink-0';
                iconWrapper.innerHTML = `<i data-lucide="${tab.icon}" class="w-4 h-4"></i>`;
                const textElement = document.createElement('span');
                textElement.className = `tab-text ${isSelected ? 'expanded' : ''}`;
                textElement.textContent = tab.title;
                button.appendChild(iconWrapper);
                button.appendChild(textElement);
                button.addEventListener('mouseenter', () => {
                    if (!button.classList.contains('selected')) {
                        button.style.color = 'rgba(255, 255, 255, 0.9)';
                    }
                });
                button.addEventListener('mouseleave', () => {
                    if (!button.classList.contains('selected')) {
                        button.style.color = 'rgba(255, 255, 255, 0.6)';
                    }
                });
                return button;
            }
            handleSelect(index) {
                this.selected = index;
                const buttons = this.container.querySelectorAll('.tab-button');
                buttons.forEach((button, i) => {
                    const buttonIndex = parseInt(button.dataset.index);
                    const textElement = button.querySelector('.tab-text');
                    if (this.selected === buttonIndex) {
                        button.classList.add('selected');
                        button.style.color = this.activeColor || 'rgb(147, 197, 253)';
                        textElement.classList.add('expanded');
                    } else {
                        button.classList.remove('selected');
                        button.style.color = 'rgba(255, 255, 255, 0.6)';
                        textElement.classList.remove('expanded');
                    }
                });
                this.onChange(this.selected);
            }
            bindEvents() {
                if (this.eventsbound) return;
                this.eventsbound = true;
                this.container.addEventListener('click', (e) => {
                    const button = e.target.closest('.tab-button');
                    if (button && button.dataset.index !== undefined) {
                        this.handleSelect(parseInt(button.dataset.index));
                    }
                });
            }
        }
       
        function showContentSection(tabTitle) {
           
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            
           
            let sectionId = '';
            switch(tabTitle) {
                case 'Add Blogs':
                    sectionId = 'addBlogs';
                    break;
                case 'Edit/Delete Blog':
                    sectionId = 'editBlogs';
                    break;
                // case 'Manage Images':
                //     sectionId = 'manageImages';
                    break;
            }
            
            if (sectionId) {
                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
            }
        }
        
       
        function handleFormSubmit(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
           
            if (!data.blogDate) {
                const today = new Date().toISOString().split('T')[0];
                data.blogDate = today;
            }
            
            console.log('Form submitted:', data);
            alert('Blog added successfully! (This is a demo)');
            event.target.reset();
        }
        
       
        async function handleLoadPreview() {
            const form = document.getElementById('addBlogForm');
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
               
                if (!key.startsWith('dynamic_')) {
                    data[key] = value;
                }
            }
            
           
            if (!data.blogDate) {
                const today = new Date().toISOString().split('T')[0];
                data.blogDate = today;
                document.getElementById('blogDate').value = today;
            }
            
           
            const dynamicSections = collectDynamicSections();
            data.dynamicSections = dynamicSections;
            
            try {
               
                const loadPreviewBtn = document.getElementById('loadPreviewBtn');
                const originalText = loadPreviewBtn.innerHTML;
                loadPreviewBtn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 mr-2 animate-spin"></i>Loading...';
                loadPreviewBtn.disabled = true;
                
               
                const response = await fetch('/admin_blog_preview', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                
               
                loadPreviewBtn.innerHTML = originalText;
                loadPreviewBtn.disabled = false;
                
                if (result.status === 'success') {
                   
                    const previewWindow = window.open('', 'preview', 'width=800,height=600,scrollbars=yes');
                    previewWindow.document.write(result.data);
                    previewWindow.document.close();
                } else {
                    alert('Error generating preview: ' + (result.message || 'Unknown error'));
                }
                
            } catch (error) {
               
                const loadPreviewBtn = document.getElementById('loadPreviewBtn');
                loadPreviewBtn.innerHTML = '<i data-lucide="eye" class="w-4 h-4 mr-2"></i>Load Preview';
                loadPreviewBtn.disabled = false;
                
                console.error('Error loading preview:', error);
                alert('Error loading preview: ' + error.message);
            }
        }
        
       
        async function handleSaveDraft() {
            const form = document.getElementById('addBlogForm');
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
               
                if (!key.startsWith('dynamic_')) {
                    data[key] = value;
                }
            }
            
           
            if (!data.blogDate) {
                const today = new Date().toISOString().split('T')[0];
                data.blogDate = today;
                document.getElementById('blogDate').value = today;
            }
            
           
            const dynamicSections = collectDynamicSections();
            data.dynamicSections = dynamicSections;
            
           
            data.status = 'draft';
            data.enc_email = localStorage.getItem('enc_email') || '';
            data.enc_pwd = localStorage.getItem('enc_pwd') || '';
            data.base_url = window.location.origin;
            
            try {
               
                const saveDraftBtn = document.getElementById('saveDraftBtn');
                const originalText = saveDraftBtn.innerHTML;
                saveDraftBtn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 mr-2 animate-spin"></i>Saving...';
                saveDraftBtn.disabled = true;
                
               
                const response = await fetch('/admin_save_blog', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
               
                saveDraftBtn.innerHTML = originalText;
                saveDraftBtn.disabled = false;
                
                if (!response.ok) {
                   
                    let errorMessage = `Server error (${response.status})`;
                    try {
                        const errorResult = await response.json();
                        errorMessage = errorResult.message || errorResult.error || errorMessage;
                    } catch (e) {
                       
                        errorMessage = response.statusText || errorMessage;
                    }
                    showModal('Error Saving Draft', errorMessage, 'error');
                    return;
                }
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    let message = 'Blog saved as draft successfully!';
                    if (result.url) {
                        message += `\n\nBlog URL: ${result.url}`;
                    }
                    showModal('Success', message, 'success');
                } else {
                    showModal('Error Saving Draft', result.message || 'Unknown error', 'error');
                }
                
            } catch (error) {
               
                const saveDraftBtn = document.getElementById('saveDraftBtn');
                saveDraftBtn.innerHTML = '<i data-lucide="file-text" class="w-4 h-4 mr-2"></i>Save as Draft';
                saveDraftBtn.disabled = false;
                
                console.error('Error saving draft:', error);
                showModal('Error Saving Draft', error.message, 'error');
            }
        }
        
       
        async function handleSavePublish() {
            const form = document.getElementById('addBlogForm');
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
               
                if (!key.startsWith('dynamic_')) {
                    data[key] = value;
                }
            }
            
           
            if (!data.blogDate) {
                const today = new Date().toISOString().split('T')[0];
                data.blogDate = today;
                document.getElementById('blogDate').value = today;
            }
            
           
            const dynamicSections = collectDynamicSections();
            data.dynamicSections = dynamicSections;
            
           
            data.status = 'published';
            data.enc_email = localStorage.getItem('enc_email') || '';
            data.enc_pwd = localStorage.getItem('enc_pwd') || '';
            data.base_url = window.location.origin;
            
            try {
               
                const savePublishBtn = document.getElementById('savePublishBtn');
                const originalText = savePublishBtn.innerHTML;
                savePublishBtn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 mr-2 animate-spin"></i>Publishing...';
                savePublishBtn.disabled = true;
                
               
                const response = await fetch('/admin_save_blog', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
               
                savePublishBtn.innerHTML = originalText;
                savePublishBtn.disabled = false;
                
                if (!response.ok) {
                   
                    let errorMessage = `Server error (${response.status})`;
                    try {
                        const errorResult = await response.json();
                        errorMessage = errorResult.message || errorResult.error || errorMessage;
                    } catch (e) {
                       
                        errorMessage = response.statusText || errorMessage;
                    }
                    showModal('Error Publishing Blog', errorMessage, 'error');
                    return;
                }
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    let message = 'Blog published successfully!';
                    if (result.url) {
                        message += `\n\nBlog URL: ${result.url}`;
                    }
                    showModal('Success', message, 'success');
                   
                    form.reset();
                   
                    document.getElementById('dynamicSections').innerHTML = '';
                    sectionCounter = 0;
                } else {
                    showModal('Error Publishing Blog', result.message || 'Unknown error', 'error');
                }
                
            } catch (error) {
               
                const savePublishBtn = document.getElementById('savePublishBtn');
                savePublishBtn.innerHTML = '<i data-lucide="send" class="w-4 h-4 mr-2"></i>Save & Publish';
                savePublishBtn.disabled = false;
                
                console.error('Error publishing blog:', error);
                showModal('Error Publishing Blog', error.message, 'error');
            }
        }
        
       
        let sectionCounter = 0;
        
        function createDynamicSection(type, content = '') {
            sectionCounter++;
            const sectionId = `section_${sectionCounter}`;
            const sectionDiv = document.createElement('div');
            sectionDiv.className = 'dynamic-section p-4 rounded-lg  relative';
            sectionDiv.dataset.sectionId = sectionId;
            sectionDiv.dataset.sectionType = type;
            
            let sectionHTML = '';
            
            switch(type) {
                case 'text':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="type" class="w-4 h-4 mr-2"></i>Text Content
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <textarea name="dynamic_text_${sectionId}" class="form-input" style="height: 4rem; resize: vertical;" placeholder="Enter your text content...">${content}</textarea>
                    `;
                    break;
                case 'header':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="heading" class="w-4 h-4 mr-2"></i>Header
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <input type="text" name="dynamic_header_${sectionId}" class="form-input" placeholder="Enter header text..." value="${content}">
                    `;
                    break;
                case 'subheader':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="heading-2" class="w-4 h-4 mr-2"></i>SubHeader
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <input type="text" name="dynamic_subheader_${sectionId}" class="form-input" placeholder="Enter subheader text..." value="${content}">
                    `;
                    break;
                case 'subheader-text':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="heading-3" class="w-4 h-4 mr-2"></i>Subheader Text
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <textarea name="dynamic_subheader_text_${sectionId}" class="form-input" style="height: 3rem; resize: vertical;" placeholder="Enter subheader text content...">${content}</textarea>
                    `;
                    break;
                case 'image':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="image" class="w-4 h-4 mr-2"></i>Image + Alt Text
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="space-y-2">
                            <input type="url" name="dynamic_image_url_${sectionId}" class="form-input" placeholder="Image URL..." value="${content.url || ''}">
                            <input type="text" name="dynamic_image_alt_${sectionId}" class="form-input" placeholder="Alt text for image..." value="${content.alt || ''}">
                        </div>
                    `;
                    break;
            }
            
            sectionDiv.innerHTML = sectionHTML;
            return sectionDiv;
        }
        
        function addDynamicSection(type) {
            const container = document.getElementById('dynamicSections');
            const section = createDynamicSection(type);
            container.appendChild(section);
            
           
            lucide.createIcons();
            
           
            const removeBtn = section.querySelector('.remove-section');
            removeBtn.addEventListener('click', function() {
                section.remove();
                updatePreviewIfVisible();
            });
            
           
            const inputs = section.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('input', updatePreviewIfVisible);
            });
            
           
            setTimeout(() => {
                section.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            }, 100);
            
            updatePreviewIfVisible();
        }
        
        function updatePreviewIfVisible() {
           
           
        }
        
        function collectDynamicSections() {
            const sections = [];
            const dynamicSections = document.querySelectorAll('.dynamic-section');
            
            dynamicSections.forEach(section => {
                const type = section.dataset.sectionType;
                const sectionId = section.dataset.sectionId;
                
                let sectionData = { type, id: sectionId };
                
                switch(type) {
                    case 'text':
                        sectionData.content = section.querySelector(`[name="dynamic_text_${sectionId}"]`).value;
                        break;
                    case 'header':
                        sectionData.content = section.querySelector(`[name="dynamic_header_${sectionId}"]`).value;
                        break;
                    case 'subheader':
                        sectionData.content = section.querySelector(`[name="dynamic_subheader_${sectionId}"]`).value;
                        break;
                    case 'subheader-text':
                        sectionData.content = section.querySelector(`[name="dynamic_subheader_text_${sectionId}"]`).value;
                        break;
                    case 'image':
                        sectionData.content = {
                            url: section.querySelector(`[name="dynamic_image_url_${sectionId}"]`).value,
                            alt: section.querySelector(`[name="dynamic_image_alt_${sectionId}"]`).value
                        };
                        break;
                }
                
                sections.push(sectionData);
            });
            
            return sections;
        }
        
        // Blog management variables
        let currentPage = 1;
        let totalPages = 1;
        let searchTimeout = null;
        const blogsPerPage = 8;
        
        // Search and load blogs function
        async function searchAndLoadBlogs(searchKeyword = '', page = 1) {
            const blogsLoading = document.getElementById('blogsLoading');
            const noBlogsFound = document.getElementById('noBlogsFound');
            const blogsList = document.getElementById('blogsList');
            const paginationControls = document.getElementById('paginationControls');
            
            // Show loading state
            blogsLoading.classList.remove('hidden');
            noBlogsFound.classList.add('hidden');
            blogsList.innerHTML = '';
            paginationControls.classList.add('hidden');
            
            try {
                const response = await fetch(`/get_blog_list?search_keyword=${encodeURIComponent(searchKeyword)}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                
                // Hide loading state
                blogsLoading.classList.add('hidden');
                
                if (result.status === 'success' && result.blogs && result.blogs.length > 0) {
                    // Calculate pagination
                    const startIndex = (page - 1) * blogsPerPage;
                    const endIndex = startIndex + blogsPerPage;
                    const paginatedBlogs = result.blogs.slice(startIndex, endIndex);
                    totalPages = Math.ceil(result.blogs.length / blogsPerPage);
                    currentPage = page;
                    
                    // Display blogs
                    displayBlogs(paginatedBlogs);
                    
                    // Show pagination if needed
                    if (totalPages > 1) {
                        updatePaginationControls();
                        paginationControls.classList.remove('hidden');
                    }
                } else {
                    // Show no results state
                    noBlogsFound.classList.remove('hidden');
                }
                
            } catch (error) {
                console.error('Error fetching blogs:', error);
                blogsLoading.classList.add('hidden');
                
                // Show search to get started message
                blogsList.innerHTML = `
                    <div class="text-center py-8">
                        <i data-lucide="search" class="w-12 h-12 mx-auto mb-4 text-white/40"></i>
                        <h3 class="text-lg font-semibold mb-2 text-white/80">Search to get started</h3>
                        <p class="text-white/60">Use the search bar above to find blogs to edit or delete.</p>
                    </div>
                `;
                lucide.createIcons();
            }
        }
        
        // Display blogs function
        function displayBlogs(blogs) {
            const blogsList = document.getElementById('blogsList');
            
            blogsList.innerHTML = blogs.map(blog => {
                // Extract data from the nested json_data structure
                const jsonData = blog.json_data || {};
                const title = jsonData.blogTitle || 'Untitled';
                const author = jsonData.blogAuthor || 'Unknown';
                const date = jsonData.blogDate || blog.created_at;
                const status = blog.status || 'draft';
                const mainImageUrl = jsonData.mainImageUrl || '';
                const mainImageAlt = jsonData.mainImageAlt || '';
                
                return `
                    <div class="p-4 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-colors">
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex-1">
                                <h3 class="font-semibold mb-2 text-white line-clamp-2">${escapeHtml(title)}</h3>
                                <p class="text-sm text-white/60 mb-2 flex items-center gap-2 flex-wrap">
                                    <span class="flex items-center gap-1">
                                        <i data-lucide="user" class="w-3 h-3"></i>
                                        <span>By ${escapeHtml(author)}</span>
                                    </span>
                                    <span>•</span>
                                    <span class="flex items-center gap-1">
                                        <i data-lucide="calendar" class="w-3 h-3"></i>
                                        <span>${formatDate(date)}</span>
                                    </span>
                                    <span>•</span>
                                    <span class="px-2 py-1 rounded-full text-xs ${status === 'published' ? 'bg-green-600/20 text-green-400' : 'bg-yellow-600/20 text-yellow-400'}">${status}</span>
                                </p>
                            </div>
                            ${mainImageUrl ? `
                                <div class="ml-4 flex-shrink-0">
                                    <img src="${escapeHtml(mainImageUrl)}" alt="${escapeHtml(mainImageAlt)}"
                                         class="w-16 h-16 object-cover rounded-lg border border-white/10">
                                </div>
                            ` : ''}
                        </div>
                        <div class="flex gap-2 flex-wrap">
                            <button class="form-button text-xs px-3 py-1 bg-white/10 hover:bg-white/20 border border-white/20 text-white" onclick="editBlog('${blog.id.replace("'","[quotetation_here]")}')">
                                <i data-lucide="edit" class="w-3 h-3 mr-1"></i>
                                Edit
                            </button>
                            <button class="form-button text-xs px-3 py-1 bg-white/10 hover:bg-white/20 border border-white/20 text-white" onclick="deleteBlog('${blog.id.replace("'","[quotetation_here]")}', '${title.replace("'", "[quotetation_here]")}')">
                                <i data-lucide="trash-2" class="w-3 h-3 mr-1"></i>
                                Delete
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            lucide.createIcons();
        }
        
        // Update pagination controls
        function updatePaginationControls() {
            const prevBtn = document.getElementById('prevPage');
            const nextBtn = document.getElementById('nextPage');
            const pageInfo = document.getElementById('pageInfo');
            
            prevBtn.disabled = currentPage <= 1;
            nextBtn.disabled = currentPage >= totalPages;
            pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;
        }
        
        // Utility functions
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function formatDate(dateString) {
            if (!dateString) return 'No date';
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
            } catch (e) {
                return dateString;
            }
        }
        
        // Global variable to track current editing blog
        let currentEditingBlog = null;
        
        // Blog action functions
        async function editBlog(blogId) {
            blogId = blogId.replace("[quotetation_here]", "'");
            if (!blogId) {
                showModal('Error', 'Blog ID not found', 'error');
                return;
            }
            
            try {
                // Find the blog data from the current blogs list
                const searchKeyword = document.getElementById('searchBlog').value.trim();
                const response = await fetch(`/get_blog_list?search_keyword=${encodeURIComponent(searchKeyword)}`);
                const result = await response.json();
                
                if (result.status === 'success' && result.blogs) {
                    const blog = result.blogs.find(b => b.id === blogId);
                    if (blog) {
                        populateEditForm(blog);
                        switchToEditMode();
                        // Switch to Add Blogs tab to show the form
                        showContentSection('Add Blogs');
                    } else {
                        showModal('Error', 'Blog not found', 'error');
                    }
                } else {
                    showModal('Error', 'Failed to load blog data', 'error');
                }
            } catch (error) {
                console.error('Error loading blog for edit:', error);
                showModal('Error', 'An error occurred while loading the blog. Please try again.', 'error');
            }
        }
        
        function populateEditForm(blog) {
            currentEditingBlog = blog;
            const jsonData = blog.json_data || {};
            
            // Populate basic fields
            document.getElementById('mainImageUrl').value = jsonData.mainImageUrl || '';
            document.getElementById('mainImageAlt').value = jsonData.mainImageAlt || '';
            document.getElementById('blogTitle').value = jsonData.blogTitle || '';
            document.getElementById('blogAuthor').value = jsonData.blogAuthor || '';
            document.getElementById('blogDate').value = jsonData.blogDate || '';
            document.getElementById('blogSummary').value = jsonData.blogSummary || '';
            
            // Set status radio button
            const statusRadios = document.querySelectorAll('input[name="blogStatus"]');
            statusRadios.forEach(radio => {
                radio.checked = radio.value === blog.status;
            });
            
            // Populate ad banners
            document.querySelector('input[name="adBannerBesideUrl"]').value = jsonData.adBannerBesideUrl || '';
            document.querySelector('input[name="adBannerBesideHref"]').value = jsonData.adBannerBesideHref || '';
            document.querySelector('input[name="adBannerBelowUrl"]').value = jsonData.adBannerBelowUrl || '';
            document.querySelector('input[name="adBannerBelowHref"]').value = jsonData.adBannerBelowHref || '';
            
            // Clear existing dynamic sections
            document.getElementById('dynamicSections').innerHTML = '';
            sectionCounter = 0;
            
            // Populate dynamic sections
            if (jsonData.dynamicSections && Array.isArray(jsonData.dynamicSections)) {
                jsonData.dynamicSections.forEach(section => {
                    const sectionElement = createDynamicSection(section.type, section.content);
                    document.getElementById('dynamicSections').appendChild(sectionElement);
                    
                    // Add event listeners for remove buttons
                    const removeBtn = sectionElement.querySelector('.remove-section');
                    removeBtn.addEventListener('click', function() {
                        sectionElement.remove();
                    });
                });
            }
            
            lucide.createIcons();
        }
        
        function switchToEditMode() {
            // Update form title
            document.querySelector('#addBlogs .section-title').textContent = 'Edit Blog';
            
            // Show status section
            document.getElementById('blogStatusSection').style.display = 'block';
            
            // Hide add mode buttons, show edit mode buttons
            document.getElementById('addModeButtons').style.display = 'none';
            document.getElementById('editModeButtons').style.display = 'flex';
        }
        
        function switchToAddMode() {
            // Reset form title
            document.querySelector('#addBlogs .section-title').textContent = 'Add New Blog';
            
            // Hide status section
            document.getElementById('blogStatusSection').style.display = 'none';
            
            // Show add mode buttons, hide edit mode buttons
            document.getElementById('addModeButtons').style.display = 'flex';
            document.getElementById('editModeButtons').style.display = 'none';
            
            // Clear current editing blog
            currentEditingBlog = null;
            
            // Reset form
            document.getElementById('addBlogForm').reset();
            document.getElementById('dynamicSections').innerHTML = '';
            sectionCounter = 0;
        }
        
        // Handle update blog functionality
        async function handleUpdateBlog() {
            if (!currentEditingBlog) {
                showModal('Error', 'No blog selected for editing', 'error');
                return;
            }
            
            const form = document.getElementById('addBlogForm');
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
                if (!key.startsWith('dynamic_')) {
                    data[key] = value;
                }
            }
            
            // Get status from radio buttons
            const statusRadio = document.querySelector('input[name="blogStatus"]:checked');
            data.status = statusRadio ? statusRadio.value : 'draft';
            
            // Set blog date if not provided
            if (!data.blogDate) {
                const today = new Date().toISOString().split('T')[0];
                data.blogDate = today;
                document.getElementById('blogDate').value = today;
            }
            
            // Collect dynamic sections
            const dynamicSections = collectDynamicSections();
            data.dynamicSections = dynamicSections;
            
            // Add blog ID for update
            data.blog_id = currentEditingBlog.id;
            data.enc_email = localStorage.getItem('enc_email') || '';
            data.enc_pwd = localStorage.getItem('enc_pwd') || '';
            data.base_url = window.location.origin;
            data.reason = 'update';
            
            try {
                const updateBlogBtn = document.getElementById('updateBlogBtn');
                const originalText = updateBlogBtn.innerHTML;
                updateBlogBtn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 mr-2 animate-spin"></i>Updating...';
                updateBlogBtn.disabled = true;
                
                // TODO: Replace with actual update endpoint when available
                const response = await fetch('/admin_save_blog', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                updateBlogBtn.innerHTML = originalText;
                updateBlogBtn.disabled = false;
                
                if (!response.ok) {
                    let errorMessage = `Server error (${response.status})`;
                    try {
                        const errorResult = await response.json();
                        errorMessage = errorResult.message || errorResult.error || errorMessage;
                    } catch (e) {
                        errorMessage = response.statusText || errorMessage;
                    }
                    showModal('Error Updating Blog', errorMessage, 'error');
                    return;
                }
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    let message = 'Blog updated successfully!';
                    if (result.url) {
                        message += `\n\nBlog URL: ${result.url}`;
                    }
                    showModal('Success', message, 'success');
                    
                    // Switch back to add mode and refresh blog list
                    switchToAddMode();
                    showContentSection('Edit/Delete Blog');
                } else {
                    showModal('Error Updating Blog', result.message || 'Unknown error', 'error');
                }
                
            } catch (error) {
                const updateBlogBtn = document.getElementById('updateBlogBtn');
                updateBlogBtn.innerHTML = '<i data-lucide="save" class="w-4 h-4 mr-2"></i>Update Blog';
                updateBlogBtn.disabled = false;
                
                console.error('Error updating blog:', error);
                showModal('Error Updating Blog', error.message, 'error');
            }
        }
        
        async function deleteBlog(blogId, blogTitle) {
            blogId = blogId.replace("[quotetation_here]", "'");
            blogTitle = blogTitle.replace("[quotetation_here]", "'");
            if (!blogId) {
                showModal('Error', 'Blog ID not found', 'error');
                return;
            }
            
            if (confirm(`Are you sure you want to delete the blog "${blogTitle}"? This action cannot be undone.`)) {
                try {
                    const response = await fetch('/delete_blog', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            blog_id: blogId
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.status === 'success') {
                        showModal('Success', `Blog "${blogTitle}" has been deleted successfully.`, 'success');
                        // Refresh the blog list
                        const searchKeyword = document.getElementById('searchBlog').value.trim();
                        searchAndLoadBlogs(searchKeyword, currentPage);
                    } else {
                        showModal('Error', result.message || 'Failed to delete blog', 'error');
                    }
                } catch (error) {
                    console.error('Error deleting blog:', error);
                    showModal('Error', 'An error occurred while deleting the blog. Please try again.', 'error');
                }
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
            
           
            const addBlogForm = document.getElementById('addBlogForm');
            if (addBlogForm) {
                addBlogForm.addEventListener('submit', handleFormSubmit);
            }
            
           
            const loadPreviewBtn = document.getElementById('loadPreviewBtn');
            if (loadPreviewBtn) {
                loadPreviewBtn.addEventListener('click', handleLoadPreview);
            }
            
           
            const saveDraftBtn = document.getElementById('saveDraftBtn');
            if (saveDraftBtn) {
                saveDraftBtn.addEventListener('click', handleSaveDraft);
            }
            
           
            const savePublishBtn = document.getElementById('savePublishBtn');
            if (savePublishBtn) {
                savePublishBtn.addEventListener('click', handleSavePublish);
            }
            
            // Edit mode button event listeners
            const loadPreviewEditBtn = document.getElementById('loadPreviewEditBtn');
            if (loadPreviewEditBtn) {
                loadPreviewEditBtn.addEventListener('click', handleLoadPreview);
            }
            
            const deleteBlogBtn = document.getElementById('deleteBlogBtn');
            if (deleteBlogBtn) {
                deleteBlogBtn.addEventListener('click', function() {
                    if (currentEditingBlog) {
                        const title = currentEditingBlog.json_data?.blogTitle || 'Untitled';
                        deleteBlog(currentEditingBlog.id, title);
                    }
                });
            }
            
            const updateBlogBtn = document.getElementById('updateBlogBtn');
            if (updateBlogBtn) {
                updateBlogBtn.addEventListener('click', handleUpdateBlog);
            }
            
           
            document.getElementById('addTextBtn').addEventListener('click', () => addDynamicSection('text'));
            document.getElementById('addHeaderBtn').addEventListener('click', () => addDynamicSection('header'));
            document.getElementById('addSubHeaderBtn').addEventListener('click', () => addDynamicSection('subheader'));
            document.getElementById('addSubHeaderTextBtn').addEventListener('click', () => addDynamicSection('subheader-text'));
            document.getElementById('addImageBtn').addEventListener('click', () => addDynamicSection('image'));
            
            // Search functionality for Edit/Delete section
            const searchBlog = document.getElementById('searchBlog');
            if (searchBlog) {
                searchBlog.addEventListener('input', function(e) {
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        searchAndLoadBlogs(e.target.value.trim(), 1);
                    }, 300); // Debounce search
                });
            }
            
            // Pagination event listeners
            const prevPage = document.getElementById('prevPage');
            const nextPage = document.getElementById('nextPage');
            
            if (prevPage) {
                prevPage.addEventListener('click', () => {
                    if (currentPage > 1) {
                        const searchKeyword = document.getElementById('searchBlog').value.trim();
                        searchAndLoadBlogs(searchKeyword, currentPage - 1);
                    }
                });
            }
            
            if (nextPage) {
                nextPage.addEventListener('click', () => {
                    if (currentPage < totalPages) {
                        const searchKeyword = document.getElementById('searchBlog').value.trim();
                        searchAndLoadBlogs(searchKeyword, currentPage + 1);
                    }
                });
            }
            
            // Load initial blogs when Edit/Delete section is shown
            const originalShowContentSection = showContentSection;
            showContentSection = function(tabTitle) {
                // Reset to add mode when switching away from Add Blogs tab
                if (tabTitle !== 'Add Blogs' && currentEditingBlog) {
                    switchToAddMode();
                }
                
                originalShowContentSection(tabTitle);
                
                if (tabTitle === 'Edit/Delete Blog') {
                    // Load blogs when the section is first shown
                    setTimeout(() => {
                        searchAndLoadBlogs('', 1);
                    }, 100);
                }
            };
            
            const navbarTabs = [
                { title: "Homepage", icon: "home" },
                { title: "Add Blogs", icon: "plus-circle" },
                { title: "Edit/Delete Blog", icon: "edit" },
                // { title: "Manage Images", icon: "image" }
            ];
            const navbarContainer = document.getElementById('navbarTabs');
            const expandableTabs = new ExpandableTabs(navbarContainer, {
                tabs: navbarTabs,
                activeColor: 'text-blue-400',
                onChange: (index) => {
                    console.log('Navbar tab changed:', index);
                    if (index !== null && navbarTabs[index]) {
                        console.log('Selected tab:', navbarTabs[index].title);
                        if (navbarTabs[index].title === "Homepage") {
                            window.location.href = '/admin_login';
                        } else if (navbarTabs[index].title === "Add Blogs") {
                            // Clear and refresh the form when Add Blogs is clicked
                            switchToAddMode();
                            showContentSection(navbarTabs[index].title);
                        } else {
                            showContentSection(navbarTabs[index].title);
                        }
                    }
                }
            });
            expandableTabs.selected = 1;
            expandableTabs.render();
            
            // Left sidebar tab functionality
            const leftTabButtons = document.querySelectorAll('.left-tab-button');
            const leftContentSections = document.querySelectorAll('.left-content-section');
            
            leftTabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-left-tab');
                    
                    // Remove active class from all buttons
                    leftTabButtons.forEach(btn => btn.classList.remove('active'));
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Hide all content sections
                    leftContentSections.forEach(section => section.classList.remove('active'));
                    // Show corresponding content section
                    const targetSection = document.getElementById(tabName + 'Content');
                    if (targetSection) {
                        targetSection.classList.add('active');
                    }
                });
            });
            
            // Left sidebar upload and gallery functionality
            let leftFilesToUpload = [];
            let leftImageFiles = [];
            
            // Initialize left sidebar upload functionality
            const leftDropzone = document.getElementById('leftDropzone');
            const leftFileInput = document.getElementById('leftFileInput');
            const leftFileQueue = document.getElementById('leftFileQueue');
            const leftUploadBtn = document.getElementById('leftUploadBtn');
            const leftUploadBtnText = document.getElementById('leftUploadBtnText');
            
            if (leftDropzone && leftFileInput) {
                // Drag and drop functionality
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    leftDropzone.addEventListener(eventName, e => { e.preventDefault(); e.stopPropagation(); });
                });
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    leftDropzone.addEventListener(eventName, () => leftDropzone.classList.add('dragover'));
                });
                
                ['dragleave', 'drop'].forEach(eventName => {
                    leftDropzone.addEventListener(eventName, () => leftDropzone.classList.remove('dragover'));
                });
                
                leftDropzone.addEventListener('drop', (e) => handleLeftFiles(e.dataTransfer.files));
                leftFileInput.addEventListener('change', (e) => handleLeftFiles(e.target.files));
                
                function handleLeftFiles(files) {
                    const validFiles = [];
                    const invalidFiles = [];
                    
                    Array.from(files).forEach(file => {
                        if (file.type.startsWith('image/') &&
                            ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp', 'image/bmp', 'image/svg+xml'].includes(file.type.toLowerCase())) {
                            validFiles.push(file);
                        } else {
                            invalidFiles.push(file);
                        }
                    });
                    
                    if (invalidFiles.length > 0) {
                        const fileNames = invalidFiles.map(f => f.name).join(', ');
                        showToast(`Invalid file type(s): ${fileNames}. Expected: PNG, JPG, JPEG, GIF, WEBP, BMP, SVG`, 'error');
                    }
                    
                    if (validFiles.length > 0) {
                        leftFilesToUpload.push(...validFiles);
                        updateLeftFileQueueUI();
                    }
                }
                
                function updateLeftFileQueueUI() {
                    leftFileQueue.innerHTML = '';
                    if (leftFilesToUpload.length > 0) {
                        leftFilesToUpload.forEach((file, index) => {
                            const fileItem = document.createElement('div');
                            fileItem.className = 'file-queue-item';
                            fileItem.innerHTML = `
                                <div class="flex-shrink-0 mr-3">
                                    <i data-lucide="image" class="w-5 h-5 text-white/70"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="text-sm font-medium truncate">${file.name}</p>
                                    <p class="text-xs text-white/50">${(file.size / 1024 / 1024).toFixed(2)} MB</p>
                                </div>
                                <button data-index="${index}" class="remove-left-file-btn ml-4 text-white/50 hover:text-red-500 transition-colors p-1">
                                    <i data-lucide="x" class="w-5 h-5"></i>
                                </button>
                            `;
                            leftFileQueue.appendChild(fileItem);
                        });
                        lucide.createIcons();
                    }
                    leftUploadBtn.disabled = leftFilesToUpload.length === 0;
                    leftUploadBtnText.textContent = `Upload ${leftFilesToUpload.length} File${leftFilesToUpload.length !== 1 ? 's' : ''}`;
                }
                
                leftFileQueue.addEventListener('click', (e) => {
                    const removeBtn = e.target.closest('.remove-left-file-btn');
                    if (removeBtn) {
                        leftFilesToUpload.splice(parseInt(removeBtn.dataset.index), 1);
                        updateLeftFileQueueUI();
                    }
                });
                
                leftUploadBtn.addEventListener('click', async () => {
                    if (leftFilesToUpload.length === 0) {
                        showToast('No files selected for upload', 'error');
                        return;
                    }
                    
                    leftUploadBtn.disabled = true;
                    leftUploadBtnText.textContent = 'Uploading...';
                    
                    let successCount = 0;
                    let errorCount = 0;
                    
                    for (let i = 0; i < leftFilesToUpload.length; i++) {
                        const file = leftFilesToUpload[i];
                        try {
                            const formData = new FormData();
                            formData.append('file', file);
                            
                            const response = await fetch('/upload_file', {
                                method: 'POST',
                                body: formData
                            });
                            
                            const result = await response.json();
                            
                            if (response.ok && result.status === 'success') {
                                successCount++;
                            } else {
                                errorCount++;
                                console.error(`Failed to upload ${file.name}:`, result.message);
                            }
                        } catch (error) {
                            errorCount++;
                            console.error(`Network error uploading ${file.name}:`, error);
                        }
                        
                        leftUploadBtnText.textContent = `Uploading... (${i + 1}/${leftFilesToUpload.length})`;
                    }
                    
                    if (successCount > 0 && errorCount === 0) {
                        showToast(`Successfully uploaded ${successCount} file${successCount !== 1 ? 's' : ''}!`, 'success');
                    } else if (successCount > 0 && errorCount > 0) {
                        showToast(`Uploaded ${successCount} files successfully, but ${errorCount} failed`, 'warning');
                    } else {
                        showToast('All uploads failed', 'error');
                    }
                    
                    if (successCount > 0) {
                        await loadLeftGallery();
                    }
                    
                    leftFilesToUpload = [];
                    updateLeftFileQueueUI();
                    leftUploadBtn.disabled = false;
                    leftUploadBtnText.textContent = 'Upload 0 Files';
                });
            }
            
            // Gallery functionality
            async function loadLeftGallery() {
                try {
                    const response = await fetch('/get_file_details?bucket_name=blog-images');
                    const result = await response.json();
                    
                    if (result.status === 'success' && result.data) {
                        leftImageFiles = result.data.map(file => ({
                            id: file.id,
                            name: file.name,
                            url: file.public_url,
                            size: file.size
                        }));
                        renderLeftGallery();
                    }
                } catch (error) {
                    console.error('Error loading gallery:', error);
                }
            }
            
            function renderLeftGallery(searchTerm = '') {
                const galleryGrid = document.getElementById('leftGalleryGrid');
                const noItemsDiv = document.getElementById('leftNoGalleryItems');
                
                if (!galleryGrid) return;
                
                let filteredImages = leftImageFiles;
                if (searchTerm) {
                    filteredImages = leftImageFiles.filter(item =>
                        item.name.toLowerCase().includes(searchTerm.toLowerCase())
                    );
                }
                
                galleryGrid.innerHTML = '';
                
                if (filteredImages.length === 0) {
                    noItemsDiv.classList.remove('hidden');
                } else {
                    noItemsDiv.classList.add('hidden');
                    filteredImages.forEach(item => {
                        const itemEl = document.createElement('div');
                        itemEl.className = 'gallery-item group aspect-square';
                        itemEl.innerHTML = `
                            <img src="${item.url}" alt="${item.name}" class="absolute inset-0 w-full h-full object-cover" loading="lazy">
                            <div class="overlay"></div>
                            <div class="relative z-10 text-white p-2 flex flex-col justify-end h-full opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                <p class="text-xs font-semibold truncate">${item.name}</p>
                            </div>
                            <div class="actions">
                                <button class="action-btn" data-action="copy" data-url="${item.url}" title="Copy URL">
                                    <i data-lucide="link" class="w-3 h-3 text-white"></i>
                                </button>
                                <button class="action-btn" data-action="view" data-url="${item.url}" title="View">
                                    <i data-lucide="external-link" class="w-3 h-3 text-white"></i>
                                </button>
                                <button class="action-btn delete" data-action="delete" data-id="${item.id}" data-name="${item.name}" title="Delete">
                                    <i data-lucide="trash-2" class="w-3 h-3 text-white"></i>
                                </button>
                            </div>
                        `;
                        galleryGrid.appendChild(itemEl);
                    });
                }
                lucide.createIcons();
            }
            
            // Gallery actions
            const leftGalleryGrid = document.getElementById('leftGalleryGrid');
            if (leftGalleryGrid) {
                leftGalleryGrid.addEventListener('click', (e) => {
                    const actionBtn = e.target.closest('.action-btn');
                    if (!actionBtn) return;
                    
                    const action = actionBtn.dataset.action;
                    const itemUrl = actionBtn.dataset.url;
                    const itemId = actionBtn.dataset.id;
                    const itemName = actionBtn.dataset.name;
                    
                    if (action === 'copy') {
                        if (navigator.clipboard && window.isSecureContext) {
                            navigator.clipboard.writeText(itemUrl).then(() => {
                                showToast('URL copied to clipboard!', 'success');
                            }).catch(() => {
                                fallbackCopyTextToClipboard(itemUrl);
                            });
                        } else {
                            fallbackCopyTextToClipboard(itemUrl);
                        }
                    } else if (action === 'view') {
                        window.open(itemUrl, '_blank');
                    } else if (action === 'delete') {
                        handleLeftGalleryDelete(itemId, itemName);
                    }
                });
            }
            
            function fallbackCopyTextToClipboard(text) {
                const textArea = document.createElement("textarea");
                textArea.value = text;
                textArea.style.position = "fixed";
                textArea.style.top = "0";
                textArea.style.left = "0";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                    showToast('URL copied to clipboard!', 'success');
                } catch (err) {
                    console.error('Failed to copy', err);
                    showToast('Failed to copy URL', 'error');
                }
                document.body.removeChild(textArea);
            }
            
            // Search functionality
            const leftSearchInput = document.getElementById('leftSearchInput');
            if (leftSearchInput) {
                const leftSearchContainer = leftSearchInput.parentElement;
                
                leftSearchInput.addEventListener('focus', () => {
                    leftSearchContainer.classList.add('focused');
                });
                
                leftSearchInput.addEventListener('blur', () => {
                    leftSearchContainer.classList.remove('focused');
                });
                
                leftSearchInput.addEventListener('input', (e) => {
                    const searchTerm = e.target.value.trim();
                    renderLeftGallery(searchTerm);
                });
            }
            
            // Toast notification function
            function showToast(message, type = 'success') {
                const toast = document.createElement('div');
                let bgColor = 'bg-green-600';
                if (type === 'error') {
                    bgColor = 'bg-red-600';
                } else if (type === 'warning') {
                    bgColor = 'bg-yellow-600';
                }
                toast.className = `fixed top-4 right-4 ${bgColor} text-white px-4 py-2 rounded-lg shadow-lg z-50 transition-all duration-300`;
                toast.textContent = message;
                document.body.appendChild(toast);
                setTimeout(() => {
                    toast.style.opacity = '0';
                    toast.style.transform = 'translateY(-20px)';
                    setTimeout(() => {
                        if (toast.parentElement) {
                            document.body.removeChild(toast);
                        }
                    }, 300);
                }, 3000);
            }
            
            // Delete function for left gallery
            async function handleLeftGalleryDelete(itemId, itemName) {
                if (!itemName) {
                    console.error('No file name provided to handleLeftGalleryDelete');
                    showToast('Error: File name is missing', 'error');
                    return;
                }
                
                if (confirm(`Are you sure you want to delete "${itemName}"? This action cannot be undone.`)) {
                    showToast('Deleting file...', 'success');
                    
                    try {
                        const response = await fetch('/delete_file', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                file_name: itemName
                            })
                        });
                        
                        const result = await response.json();
                        
                        if (response.ok && result.status === 'success') {
                            // Remove from local array
                            const itemIndex = leftImageFiles.findIndex(item => item.id == itemId);
                            if (itemIndex > -1) {
                                leftImageFiles.splice(itemIndex, 1);
                                renderLeftGallery();
                                showToast(`File "${itemName}" deleted successfully!`, 'success');
                            } else {
                                await loadLeftGallery();
                                showToast(`File "${itemName}" deleted successfully!`, 'success');
                            }
                        } else {
                            console.error('Delete failed:', result.message);
                            showToast(`Failed to delete file: ${result.message || 'Unknown error'}`, 'error');
                        }
                    } catch (error) {
                        console.error('Error deleting file:', error);
                        showToast(`Error deleting file: ${error.message}`, 'error');
                    }
                }
            }
            
            // Load gallery when gallery tab is clicked
            leftTabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-left-tab');
                    if (tabName === 'gallery') {
                        setTimeout(() => {
                            loadLeftGallery();
                        }, 100);
                    }
                });
            });
            
            setTimeout(() => {
                lucide.createIcons();
            }, 100);
        });
    </script>
</body>
</html>